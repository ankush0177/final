<!DOCTYPE html>
<html lang="en">

<head>
    <title> Montreal Bakery Store</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <style>
        body {
            background: hsla(286, 48%, 91%, 1);
            background: linear-gradient(90deg, hsla(286, 48%, 91%, 1) 0%, hsla(349, 25%, 61%, 1) 0%, hsla(247, 17%, 39%, 1) 100%);
            background: -moz-linear-gradient(90deg, hsla(286, 48%, 91%, 1) 0%, hsla(349, 25%, 61%, 1) 0%, hsla(247, 17%, 39%, 1) 100%);
            background: -webkit-linear-gradient(90deg, hsla(286, 48%, 91%, 1) 0%, hsla(349, 25%, 61%, 1) 0%, hsla(247, 17%, 39%, 1) 100%);
            filter: progid: DXImageTransform.Microsoft.gradient(startColorstr="#EEDDF3", endColorstr="#B4828B", GradientType=1);
        }
    </style>
    <link rel="stylesheet" href="style.css" />
    <script src="https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.24/js/dataTables.bootstrap.min.js"></script>
    <script src="script.js"></script>
    <style>
        .row {
            margin-right: 0;
            margin-left: 0;
        }

        .jumbotron {
            padding-top: 18px;
            padding-bottom: 18px;
            padding-right: 20px;
            padding-left: 20px;
        }

        .container .jumbotron {
            padding-right: 20px;
            padding-left: 30px;
        }
    </style>
</head>

<body>
    <header>
        <div class="row">
            <div class="container head-row">
                <h1 class="logo">


                    <!-- Montreal <span style="color:brown;font-size: 40px;">Bakery</span> Store -->

                    <img src="images/logo2.png" />


                </h1>

                <ul class="menu">
                    <li class=""><a href="home.html">Home</a></li>

                    <li>
                        <div class="dropdown">
                            <a>Galleries</a>
                            <div class="dropdown-content">
                                <a href="types.html?cat=Birthdays">Birthdays</a>
                                <a href="types.html?cat=Weddings">Weddings</a>
                                <a href="types.html?cat=Festivals">Festivals</a>
                                <a href="types.html?cat=Anniversaries">Anniversaries</a>
                                <a href="types.html?cat=NewYear">New Year</a>
                                <a href="types.html?cat=CupCakes">Cup Cakes</a>
                                <a href="types.html?cat=Crossaints">Crossaints</a>
                                <a href="types.html?cat=MilkShakes">MilkShakes</a>
                            </div>
                        </div>
                    </li>
                    <li><a href="mybookings.html">My Orders</a></li>
                    <li><a href="help.html">Help</a></li>
                    <li><a href="profile.html">Profile</a></li>
                    <li><a href="addtocart.html"><button><span
                                    class="glyphicon glyphicon-shopping-cart"></span></button></a></li>

                    <li><a href="index.html">Logout</a></li>
                </ul>
            </div>
        </div>
    </header>
    <div class="row">

        <div class="container" style="padding-top: 0px;height: 700px;">
            <h2 class="page-heading" style="color: white;">Check Out</h2>
            <hr style="width: 80%;" />

            <div class="col-sm-12">


                <div class="row">
                    <div class="container" style="padding-top: 0px;height: 700px;">

                        <div class="col-sm-10 col-sm-offset-1">



                            <table id="inventory" class="table table-striped table-bordered" style="width:100%">
                                <thead>
                                    <tr>

                                        <th>Category</th>
                                        <th>Flavour</th>
                                        <th>Color</th>
                                        <th>Size</th>
                                        <th>Kg</th>
                                        <th>toppings</th>
                                        <th>price</th>
                                        <th>date</th>
                                        <th>tim</th>
                                        <th>quantity</th>
                                        <th>total</th>

                                    </tr>
                                </thead>

                                <tbody id="cakeData">
                                </tbody>
                            </table>

                            <div style="text-align: right;">
                                <h2 style="color: white;">Grand Total : <span id="tot"></span></h2>
                                <div class="form-group" align="right">
                                    <label style="color: white;">Payment Mode</label>
                                    <select class="form-control" id="pmode">

                                        <option>Cash</option>
                                        <option>Debit/Credit Card</option>

                                    </select>

                                </div>
                                <div id="p" align="right">


                                    <table style="border: 1px solid white;width: 50%;padding: auto;">
                                        <tr>
                                            <td colspan="2">
                                                <div class="form-group">
                                                    <label>Full Name</label>
                                                    <input type="text" id="cardname" required>

                                                </div>

                                            </td>
                                        </tr>

                                        <tr>
                                            <td>
                                                <div class="form-group">
                                                    <label>Card No</label>
                                                    <input type="text" id="cardname">

                                                </div>
                                            </td>
                                            <td>
                                                <div class="form-group">
                                                    <label>Cvv</label>
                                                    <input type="password" style="width: 100px;" id="cardname">

                                                </div>
                                            </td>
                                        </tr>

                                        <tr>
                                            <td>
                                                <p id="total"></p>
                                            </td>
                                        </tr>

                                        <!-- <tr>
                                            <td colspan="2">
                                                <button type="submit" id="btn_pay">Pay</button>

                                            </td>
                                        </tr> -->
                                    </table>

                                </div>
                                <div style="margin-bottom:10px;">
                                    <button type="submit" id="btn_payment">Pay Now</button>
                                </div>
                            </div>




                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>


    <hr />
    <div class="container">
        <div class="row" style="align-content: center;padding-left: 150px;">

            <div class="col-lg-2 col-md-2 footer-links">
                <h4 style="color:white">Links</h4>
                <ul>
                    <li><i class="bx bx-chevron-right"></i> <a href="index.html">Home</a></li>
                    <li><i class="bx bx-chevron-right"></i> <a href="about.html">About us</a></li>
                    <li><i class="bx bx-chevron-right"></i> <a href="contact.html">Contact</a></li>
                </ul>
            </div>

            <div class="col-lg-4 col-md-4 footer-contact">
                <h4 style="color:white">Contact Us</h4>
                <p style="color:white">
                    Quebec City <br />
                    Canada
                    <strong>Phone:</strong> +1 512564123<br>
                    <strong>Email:</strong> bakery@gmail.com<br>
                </p>

                <a href="https://www.facebook.com/"><i style="font-size:24px" class="fa">&#xf082;</i></a>
                <a href="https://twitter.com/LOGIN"><i style="font-size:24px" class="fa">&#xf081;</i></a>
                <a href="https://www.youtube.com/watch?v=MBSp6vWamh4"><i style="font-size:24px"
                        class="fa">&#xf167;</i></a>
            </div>

            <div class="col-lg-4 col-md-4 footer-info">
                <h4 style="color:white">About Montreal Bakery Store</h4>
                <p style="color:white">
                    Montreal Bakery is one of the best cake delivery in Montreal. It is committed to making your special
                    day memorable by bringing zeal and happiness together. They aim to offer hassle-free cake services
                    and their delivery to their customers. It has created an almost infinite range of cake styles that
                    can all be personalised to create a unique centerpiece for any event.

                </p>

            </div>

        </div>
    </div>


    <script type="text/javascript">


        $('#pmode').change(function () {
            var pmode = $('#pmode').val();

            if (pmode == "Cash") {
                debugger
                alert("Cash Payment");
                $("#p").hide();
            }
            else if (pmode == "Debit/Credit Card") {
                alert("Card Payment");
                $("#p").show();
                debugger
            }
            else {
                alert("Please Select Payment Mode");
                $("#p").hide();
            }
        });




        $('#btn_payment').click(() => {

            var retrievedObject = localStorage.getItem('added-items');
            var parsedObject = JSON.parse(retrievedObject);
            console.log(parsedObject);
            debugger
        
            $.ajax({
                url: 'http://localhost:3000/addOrder',
                type: "POST",
                dataType: "json",
                contentType: 'application/json; charset=utf-8',
                data: JSON.stringify(parsedObject),
                success: (data) => {
                    try {
                        console.log(data);
                        localStorage.removeItem("added-items")
                       // localStorage.clear();
                        //$("#cakeData").remove();
                        window.location.reload();;
                        debugger
                        console.log(localStorage.getItem("username"));
                        alert("Order Placed Successfully");
                    } catch (err) {
                        console.log(err);
                        alert("failed");
                    }
                }
            })

            debugger
            console.log(localStorage.getItem("username"));
            debugger

        });








        $(document).ready(function () {
            $("#p").hide();
            var retrievedObject = localStorage.getItem('added-items');

            // CONVERT STRING TO REGULAR JS OBJECT
            var parsedObject = JSON.parse(retrievedObject);
            var tableRows = "";
            // ACCESS DATA
            console.log(parsedObject);
            var tot = 0;
            for (var i = 0; i < parsedObject.length; i++) {
                var temp = parsedObject[i];
                tot = tot + parseInt(temp.price);
                var row = "<tr>" +
                    // "<td> " + temp.cid + "</td>" +
                    // "<td>" + "<img src='" + temp.images + "' width='50px' height='50px' />" + "</td>" +
                    "<td>" + ((temp.category == undefined) ? '-' : temp.category) + " </td>" +
                    "<td> " + temp.flavour + "</td>" +
                    "<td> " + ((temp.color == undefined) ? '-' : temp.color) + "</td>" +
                    "<td> " + ((temp.size == undefined) ? '-' : temp.size) + "</td>" +
                    "<td> " + ((temp.kg == undefined) ? '-' : temp.kg) + "</td>" +
                    "<td> " + temp.toppings + "</td>" +
                    "<td> " + temp.price + "</td>" +
                    "<td> " + temp.date + "</td>" +
                    "<td> " + temp.tim + "</td>" +
                    "<td> " + temp.quantity + "</td>" +
                    "<td> " + temp.total + "</td>";

                tableRows = tableRows + row;
            }
            $('#tot').text("$" + tot + " CAD");


            $("#cakeData").append(tableRows);

        });





    </script>

</body>

</html>